
library ieee;
use ieee.std_logic_1164.all;
use IEEE.std_logic_signed.all;
use ieee.std_logic_arith.all;

entity Histogram is
port(
	iGray				   : in  std_logic_vector(11 downto 0);
	OGray				: out std_logic_vector(11 downto 0);
	iCLK, iRST	: in  std_logic);
end Histogram;
architecture rtl of Histogram is

  signal histreg       :IS ARRAY ( 0 TO 255 ) OF STD_LOGIC_VECTOR( 7 DOWNTO 0 );

  variable intGray		: integer;

  process(iCLK,iRST)
  iGray := CONV_INTEGER(iGray*255/4096);
  begin
    if (iRST = '1') then
      res : for i in 0 to 255 loop
          histreg (i) <= (others => '0');
      end loop;
    else
      histreg (CONV_INTEGER(iGray)) <=histreg (CONV_INTEGER(iGray)) + 1 ;
    end if;
  end process;


  END rtl;
